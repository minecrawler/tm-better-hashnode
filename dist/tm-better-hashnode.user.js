/**
 * // ==UserScript==
 * // @name         tm-better-hashnode
 * // @namespace    https://hashnode.com
 * // @version      0.2.1
 * // @description  Improve the Hashnode experience according to @maruru
 * // @author       Marco Alka
 * // @match        https://hashnode.com/*
 * // @source       https://github.com/minecrawler/tm-better-hashnode
 * // @updateURL    https://github.com/minecrawler/tm-better-hashnode/raw/master/dist/tm-better-hashnode.user.js
 * // @grant        GM_addStyle
 * // ==/UserScript==
 */

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,g){a!=Array.prototype&&a!=Object.prototype&&(a[c]=g.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var c=a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};
$jscomp.polyfill=function(a,c,g,e){if(c){g=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in g||(g[d]={});g=g[d]}a=a[a.length-1];e=g[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(g,a,{configurable:!0,writable:!0,value:c})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function c(){this.batch_=null}function g(b){return b instanceof d?b:new d(function(f,a){f(b)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;c.prototype.asyncExecute=function(b){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(b);return this};c.prototype.asyncExecuteBatch_=function(){var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})};var e=$jscomp.global.setTimeout;c.prototype.asyncExecuteFunction=function(b){e(b,
0)};c.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=this.batch_;this.batch_=[];for(var f=0;f<b.length;++f){var a=b[f];b[f]=null;try{a()}catch(h){this.asyncThrow_(h)}}}this.batch_=null};c.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var d=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{b(a.resolve,a.reject)}catch(k){a.reject(k)}};d.prototype.createResolveAndReject_=
function(){function b(b){return function(f){d||(d=!0,b.call(a,f))}}var a=this,d=!1;return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};d.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof d)this.settleSameAsPromise_(b);else{a:switch(typeof b){case "object":var a=null!=b;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};d.prototype.resolveToNonPromiseObj_=function(b){var a=
void 0;try{a=b.then}catch(k){this.reject_(k);return}"function"==typeof a?this.settleSameAsThenable_(a,b):this.fulfill_(b)};d.prototype.reject_=function(b){this.settle_(2,b)};d.prototype.fulfill_=function(b){this.settle_(1,b)};d.prototype.settle_=function(b,a){if(0!=this.state_)throw Error("Cannot settle("+b+", "+a+"): Promise already settled in state"+this.state_);this.state_=b;this.result_=a;this.executeOnSettledCallbacks_()};d.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var b=
0;b<this.onSettledCallbacks_.length;++b)l.asyncExecute(this.onSettledCallbacks_[b]);this.onSettledCallbacks_=null}};var l=new c;d.prototype.settleSameAsPromise_=function(b){var a=this.createResolveAndReject_();b.callWhenSettled_(a.resolve,a.reject)};d.prototype.settleSameAsThenable_=function(b,a){var d=this.createResolveAndReject_();try{b.call(a,d.resolve,d.reject)}catch(h){d.reject(h)}};d.prototype.then=function(b,a){function c(a,b){return"function"==typeof a?function(b){try{h(a(b))}catch(q){f(q)}}:
b}var h,f,e=new d(function(a,b){h=a;f=b});this.callWhenSettled_(c(b,h),c(a,f));return e};d.prototype.catch=function(a){return this.then(void 0,a)};d.prototype.callWhenSettled_=function(a,d){function b(){switch(c.state_){case 1:a(c.result_);break;case 2:d(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?l.asyncExecute(b):this.onSettledCallbacks_.push(b)};d.resolve=g;d.reject=function(a){return new d(function(b,d){d(a)})};d.race=function(a){return new d(function(b,
d){for(var c=$jscomp.makeIterator(a),e=c.next();!e.done;e=c.next())g(e.value).callWhenSettled_(b,d)})};d.all=function(a){var b=$jscomp.makeIterator(a),c=b.next();return c.done?g([]):new d(function(a,d){function e(b){return function(d){m[b]=d;f--;0==f&&a(m)}}var m=[],f=0;do m.push(void 0),f++,g(c.value).callWhenSettled_(e(m.length-1),d),c=b.next();while(!c.done)})};return d},"es6","es3");
(function(){GM_addStyle(".post-card.status-card,.widget.lets-write{display:none!important}.c-chat{position:fixed;z-index:1000;right:0;bottom:0;margin-bottom:-250px;height:250px;width:500px}.c-chat--visible{margin-bottom:0}.c-chat__input{width:calc(100% - 100px)}.c-chat__input[disabled]{cursor:not-allowed}.c-chat__input-row{display:flex;flex-direction:row}.c-chat__submit{width:100px;height:30px;margin:0;cursor:pointer}.c-chat__submit[disabled]{cursor:not-allowed}.c-chat__messages{height:calc(100% - 30px);overflow:hidden;word-wrap:break-word;overflow-y:scroll}.c-chat__visibility-btn{position:absolute;top:calc(-2em - 2px);right:0;height:2em;width:100px;cursor:pointer}.t-light.c-chat{border:1px solid #000;background-color:#fff;padding:6px 10px;transition-property:margin;transition-duration:.3s;transition-timing-function:ease-in-out}.t-light .c-chat__input{border:none}.t-light .c-chat__messages{border-bottom:1px solid #ccc}.c-chat__submit{border:0}.t-light .c-chat__submit{color:#fff;background-color:#28a745;transition-property:background-color;transition-duration:.3s;transition-timing-function:ease-in-out}.t-light .c-chat__submit:hover{background-color:#27a56c}.t-light .c-chat__visibility-btn{border:none;padding:1px 6px;color:#fff;background-color:#2fc681;transition-property:background-color;transition-duration:.3s;transition-timing-function:ease-in-out}.t-light .c-chat__visibility-btn:hover{background-color:#1e7e34}");var a=
{callRESTEndpoint:function(a){return new Promise(function(b,d){var c=new XMLHttpRequest;c.open("GET","/ajax"+("/"===a.charAt(0)?a:"/"+a));c.onerror=function(a){d({error:a,response:c.response,status:c.status})};c.ontimeout=function(){d({error:Error("Timeout exceeded"),response:c.response,status:c.status})};c.onload=function(){200<=c.status&&300>c.status?b(c.response):400<=c.status&&d({error:Error("HTTP Error ("+c.status+")"),response:c.response,status:c.status})};c.send()})}},c={getCurrentUser:function(){var a=
document.querySelector(".profile-name");return{displayName:a.innerText,username:a.href.toString().match(/\/@(.+)$/i)[1]}},getUserInfo:function(b){return new Promise(function(c,d){a.callRESTEndpoint("profile/"+b).catch(d).then(function(a){return c(JSON.parse(a).profile)})})}},g=document.querySelector("body"),e=document.createElement("div"),d=c.getCurrentUser().username;e.classList.add("c-chat");e.classList.add("t-light");e.innerHTML='\x3cbutton class\x3d"c-chat__visibility-btn / js-chat__visibility-btn"\x3eShow Chat\x3c/button\x3e \x3cdiv class\x3d"c-chat__user-list / js-chat__user-list"\x3e\x3c/div\x3e \x3cdiv class\x3d"c-chat__messages / js-chat__messages"\x3e\x3c/div\x3e \x3cdiv class\x3d"c-chat__input-row"\x3e \x3cinput type\x3d"text" maxlength\x3d"140" class\x3d"c-chat__input / js-chat__input" placeholder\x3d"Write a message"\x3e \x3cbutton type\x3d"submit" class\x3d"c-chat__submit / js-chat__submit"\x3eSend\x3c/button\x3e \x3c/div\x3e ';
var l=e.querySelector(".js-chat__visibility-btn"),b=e.querySelector(".js-chat__input"),f=e.querySelector(".js-chat__messages"),k=e.querySelector(".js-chat__submit"),h=new WebSocket("wss://localhost:1288");h.addEventListener("open",function(a){p("System","Connected to chat server")});h.addEventListener("message",function(a){a=JSON.parse(a.data);p(a.author,a.message)});var p=function(a,b){f.appendChild(document.createTextNode("["+a+"]: "+b));f.appendChild(document.createElement("br"))};g.appendChild(e);
l.addEventListener("click",function(){e.classList.toggle("c-chat--visible");e.classList.contains("c-chat--visible")?l.innerText="Hide Chat":l.innerText="Show Chat"});k.addEventListener("click",function(){""!==b.value&&(3<h.readyState&&h.send('{"author":"'+d+'","message":"'+b.value+'"}'),b.value="",b.focus(),f.scrollTop=f.scrollHeight)});setTimeout(function(){3===h.readyState&&(b.setAttribute("disabled",""),k.setAttribute("disabled",""),k.innerText="Working",p("System","Could not connect to chat server"))},
2E3);setTimeout(function(){document.querySelectorAll(".community-power.widget").forEach(function(a){return a.parentNode.removeChild(a)})},5E3);var n=c.getCurrentUser().username;c.getUserInfo(n).catch(function(a){}).then(function(a){document.querySelector('div.score-wrap \x3e a[href\x3d"/@'+n+'"] \x3e p.big').innerText=a.totalUpvotesReceived;document.querySelector('div.score-wrap \x3e a[href\x3d"/@'+n+'/followers"] \x3e p.big').innerText=a.numFollowers;document.querySelector('div.score-wrap \x3e a[href\x3d"/@'+
n+'/following"] \x3e p.big').innerText=a.numFollowing})})();
