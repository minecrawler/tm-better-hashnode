/**
 * // ==UserScript==
 * // @name         tm-better-hashnode
 * // @namespace    https://hashnode.com
 * // @version      0.2.1
 * // @description  Improve the Hashnode experience according to @maruru
 * // @author       Marco Alka
 * // @match        https://hashnode.com/*
 * // @source       https://github.com/minecrawler/tm-better-hashnode
 * // @updateURL    https://github.com/minecrawler/tm-better-hashnode/raw/master/dist/tm-better-hashnode.user.js
 * // @grant        GM_addStyle
 * // ==/UserScript==
 */

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,f){a!=Array.prototype&&a!=Object.prototype&&(a[c]=f.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var c=a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};
$jscomp.polyfill=function(a,c,f,e){if(c){f=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in f||(f[d]={});f=f[d]}a=a[a.length-1];e=f[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(f,a,{configurable:!0,writable:!0,value:c})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function c(){this.batch_=null}function f(b){return b instanceof d?b:new d(function(a,c){a(b)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;c.prototype.asyncExecute=function(b){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(b);return this};c.prototype.asyncExecuteBatch_=function(){var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})};var e=$jscomp.global.setTimeout;c.prototype.asyncExecuteFunction=function(b){e(b,
0)};c.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var b=this.batch_;this.batch_=[];for(var a=0;a<b.length;++a){var c=b[a];b[a]=null;try{c()}catch(g){this.asyncThrow_(g)}}}this.batch_=null};c.prototype.asyncThrow_=function(b){this.asyncExecuteFunction(function(){throw b;})};var d=function(b){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{b(a.resolve,a.reject)}catch(h){a.reject(h)}};d.prototype.createResolveAndReject_=
function(){function b(b){return function(d){c||(c=!0,b.call(a,d))}}var a=this,c=!1;return{resolve:b(this.resolveTo_),reject:b(this.reject_)}};d.prototype.resolveTo_=function(b){if(b===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(b instanceof d)this.settleSameAsPromise_(b);else{a:switch(typeof b){case "object":var a=null!=b;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(b):this.fulfill_(b)}};d.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(h){this.reject_(h);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};d.prototype.reject_=function(a){this.settle_(2,a)};d.prototype.fulfill_=function(a){this.settle_(1,a)};d.prototype.settle_=function(a,c){if(0!=this.state_)throw Error("Cannot settle("+a+", "+c+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=c;this.executeOnSettledCallbacks_()};d.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
0;a<this.onSettledCallbacks_.length;++a)k.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var k=new c;d.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};d.prototype.settleSameAsThenable_=function(a,c){var b=this.createResolveAndReject_();try{a.call(c,b.resolve,b.reject)}catch(g){b.reject(g)}};d.prototype.then=function(a,c){function b(a,b){return"function"==typeof a?function(b){try{g(a(b))}catch(m){f(m)}}:
b}var g,f,e=new d(function(a,b){g=a;f=b});this.callWhenSettled_(b(a,g),b(c,f));return e};d.prototype.catch=function(a){return this.then(void 0,a)};d.prototype.callWhenSettled_=function(a,c){function b(){switch(d.state_){case 1:a(d.result_);break;case 2:c(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?k.asyncExecute(b):this.onSettledCallbacks_.push(b)};d.resolve=f;d.reject=function(a){return new d(function(b,c){c(a)})};d.race=function(a){return new d(function(b,
c){for(var d=$jscomp.makeIterator(a),e=d.next();!e.done;e=d.next())f(e.value).callWhenSettled_(b,c)})};d.all=function(a){var b=$jscomp.makeIterator(a),c=b.next();return c.done?f([]):new d(function(a,d){function e(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,f(c.value).callWhenSettled_(e(g.length-1),d),c=b.next();while(!c.done)})};return d},"es6","es3");
$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var f=0,e={next:function(){if(f<a.length){var d=f++;return{value:c(d,a[d]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
(function(){GM_addStyle(".c-chat{position:fixed;z-index:1000;right:0;bottom:0;margin-bottom:-250px;height:250px;width:500px}.c-chat--visible{margin-bottom:0}.c-chat__input{width:calc(100% - 100px)}.c-chat__input[disabled]{cursor:not-allowed}.c-chat__input-row{display:flex;flex-direction:row}.c-chat__submit{width:100px;height:30px;margin:0;cursor:pointer}.c-chat__submit[disabled]{cursor:not-allowed}.c-chat__messages{height:calc(100% - 30px);overflow:hidden;word-wrap:break-word;overflow-y:scroll}.c-chat__visibility-btn{position:absolute;top:calc(-2em - 2px);right:0;height:2em;width:100px;cursor:pointer}.t-light.c-chat{border:1px solid #000;background-color:#fff;padding:6px 10px;transition-property:margin;transition-duration:.3s;transition-timing-function:ease-in-out}.t-light .c-chat__input{border:none}.t-light .c-chat__messages{border-bottom:1px solid #ccc}.c-chat__submit{border:0}.t-light .c-chat__submit{color:#fff;background-color:#28a745;transition-property:background-color;transition-duration:.3s;transition-timing-function:ease-in-out}.t-light .c-chat__submit:hover{background-color:#27a56c}.t-light .c-chat__visibility-btn{border:none;padding:1px 6px;color:#fff;background-color:#2fc681;transition-property:background-color;transition-duration:.3s;transition-timing-function:ease-in-out}.t-light .c-chat__visibility-btn:hover{background-color:#1e7e34}");var a=
document.querySelector("body"),c=document.createElement("div"),f=function(){var a=document.querySelector(".profile-name");return{displayName:a.innerText,username:a.href.toString().match(/\/@(.+)$/i)[1]}}().username;c.classList.add("c-chat");c.classList.add("t-light");c.innerHTML='\x3cbutton class\x3d"c-chat__visibility-btn / js-chat__visibility-btn"\x3eShow Chat\x3c/button\x3e \x3cdiv class\x3d"c-chat__user-list / js-chat__user-list"\x3e\x3c/div\x3e \x3cdiv class\x3d"c-chat__messages / js-chat__messages"\x3e\x3c/div\x3e \x3cdiv class\x3d"c-chat__input-row"\x3e \x3cinput type\x3d"text" maxlength\x3d"140" class\x3d"c-chat__input / js-chat__input" placeholder\x3d"Write a message"\x3e \x3cbutton type\x3d"submit" class\x3d"c-chat__submit / js-chat__submit"\x3eSend\x3c/button\x3e \x3c/div\x3e ';
var e=c.querySelector(".js-chat__visibility-btn"),d=c.querySelector(".js-chat__input"),k=c.querySelector(".js-chat__messages"),b=c.querySelector(".js-chat__submit"),l=new WebSocket("wss://localhost:1288");l.addEventListener("open",function(a){h("System","Connected to chat server")});l.addEventListener("message",function(a){a=JSON.parse(a.data);h(a.author,a.message)});var h=function(a,b){k.appendChild(document.createTextNode("["+a+"]: "+b));k.appendChild(document.createElement("br"))};a.appendChild(c);
e.addEventListener("click",function(){c.classList.toggle("c-chat--visible");c.classList.contains("c-chat--visible")?e.innerText="Hide Chat":e.innerText="Show Chat"});b.addEventListener("click",function(){""!==d.value&&(3<l.readyState&&l.send('{"author":"'+f+'","message":"'+d.value+'"}'),d.value="",d.focus(),k.scrollTop=k.scrollHeight)});setTimeout(function(){3===l.readyState&&(d.setAttribute("disabled",""),b.setAttribute("disabled",""),b.innerText="Working",h("System","Could not connect to chat server"))},
2E3);setTimeout(function(){document.querySelectorAll(".community-power.widget").forEach(function(a){return a.parentNode.removeChild(a)})},5E3)})();
